name: KubeDev-Product-API-CICD-Pipeline
on:
  push:
    branches: [ master ]
  pull_request:
    branches: [ master ]
  workflow_dispatch:
jobs:
  dockerPipeline:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2
      - name: Docker Login
        uses: docker/login-action@v1.9.0
        with:
          username: ${{secrets.DOCKER_HUB_ACCOUNT}}
          password: ${{secrets.DOCKER_HUB_PWD}}
      - name: Build and push Docker images
        # You may pin to the exact commit or the version.
        # uses: docker/build-push-action@e1b7f96249f2e4c8e4ac1519b9608c0d48944a1f
        uses: docker/build-push-action@v2.4.0
        with:
         context: ./src
         file: ./src/Dockerfile
         push: true
         tags: |
            ${{secrets.DOCKER_HUB_ACCOUNT}}/api-produto-kubedev:latest
            ${{secrets.DOCKER_HUB_ACCOUNT}}/api-produto-kubedev:${{ github.sha }}
         
